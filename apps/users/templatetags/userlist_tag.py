########################################################################################################################
## Django 自带模块导入
########################################################################################################################
from django import template

########################################################################################################################
## 系统自带模块导入
########################################################################################################################

########################################################################################################################
## 自建模块导入
########################################################################################################################
from ..models import *

register = template.Library()


########################################################################################################################
## 好友列表
########################################################################################################################
@register.simple_tag
def get_online_friends(num=10):
    return UserProfile.objects.all()[:num]


########################################################################################################################
## 好友列表
########################################################################################################################
from django.contrib.sessions.models import Session

@register.simple_tag
def get_friends_list(num=10):
    all_session = Session.objects.all()
    user_list = []
    for session in all_session:
        uid = session.get_decoded().get('_auth_user_id')
        user_list.append(uid)

    return UserProfile.objects.filter(id__in=user_list)[:num]





